{% extends "admin/base.html" %}
{% load i18n static %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'flowbite_admin/css/flowbite-admin.css' %}">
  <style>
    :root {
      color-scheme: light dark;
    }
    body {
      background-color: transparent;
    }
  </style>
{% endblock %}

{% block extrahead %}
  {{ block.super }}
  <script>
    (function () {
      const colorTheme = localStorage.getItem('color-theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (colorTheme === 'dark' || (!colorTheme && prefersDark)) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    })();
  </script>
{% endblock %}

{% block bodyclass %}{{ block.super }} bg-gray-50 dark:bg-gray-900{% endblock %}

{% block header %}
<header class="fixed inset-x-0 top-0 z-30 border-b border-gray-200 bg-white/95 backdrop-blur dark:border-gray-700 dark:bg-gray-900/95">
  <div class="mx-auto flex max-w-full items-center justify-between px-4 py-3 sm:px-6 lg:px-8">
    <div class="flex items-center gap-3">
      <button type="button" class="inline-flex items-center rounded-lg border border-gray-200 p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-800" data-drawer-target="logo-sidebar" data-drawer-toggle="logo-sidebar" aria-controls="logo-sidebar" aria-label="{% translate 'Toggle navigation' %}">
        <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
      <a href="{% url 'admin:index' %}" class="flex items-center gap-2 text-xl font-semibold text-gray-900 dark:text-white">
        <span class="inline-flex h-10 w-10 items-center justify-center rounded-lg bg-blue-600 text-lg font-bold text-white">{% firstof site_header 'FB' %}</span>
        <span class="hidden md:inline">{% firstof site_title site_header _('Flowbite Admin') %}</span>
      </a>
    </div>
    <div class="flex items-center gap-2">
      <button id="theme-toggle" type="button" class="inline-flex items-center rounded-lg border border-gray-200 p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-800" aria-label="{% translate 'Toggle dark mode' %}">
        <svg id="theme-toggle-dark-icon" class="hidden h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
          <path d="M17.293 13.293a8 8 0 11-10.586-10.586 8.001 8.001 0 1010.586 10.586z" />
        </svg>
        <svg id="theme-toggle-light-icon" class="hidden h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
          <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4.22 2.03a1 1 0 011.414 0l.708.707a1 1 0 11-1.414 1.415l-.708-.708a1 1 0 010-1.414zM17 9a1 1 0 100 2h1a1 1 0 100-2h-1zm-7 7a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zm-7-7a1 1 0 100 2H2a1 1 0 100-2h1zm1.636-5.657a1 1 0 011.414 0l.708.707A1 1 0 016.343 5.5l-.707-.708a1 1 0 010-1.414zM5.5 15.657a1 1 0 010 1.415l-.707.707a1 1 0 11-1.415-1.414l.708-.708a1 1 0 011.414 0zM15.657 14.5a1 1 0 011.414 0l.708.707a1 1 0 11-1.414 1.415l-.708-.708a1 1 0 010-1.414z" />
        </svg>
      </button>
      {% if has_permission %}
      <div class="hidden text-right text-sm sm:block">
        <p class="font-medium text-gray-900 dark:text-gray-100">{% block welcome-msg %}{% translate 'Welcome,' %} <strong>{% firstof user.get_short_name user.get_username %}</strong>{% endblock %}</p>
        <div class="mt-1 space-x-2 text-xs text-gray-500 dark:text-gray-400">
          {% block userlinks %}
            {% if site_url %}
              <a class="hover:text-blue-600" href="{{ site_url }}">{% translate 'View site' %}</a>
            {% endif %}
            {% if user.is_active and user.is_staff %}
              {% url 'django-admindocs-docroot' as docsroot %}
              {% if docsroot %}
                <span aria-hidden="true">·</span>
                <a class="hover:text-blue-600" href="{{ docsroot }}">{% translate 'Documentation' %}</a>
              {% endif %}
            {% endif %}
            {% if user.has_usable_password %}
              <span aria-hidden="true">·</span>
              <a class="hover:text-blue-600" href="{% url 'admin:password_change' %}">{% translate 'Change password' %}</a>
            {% endif %}
            <span aria-hidden="true">·</span>
            <form id="logout-form" method="post" action="{% url 'admin:logout' %}" class="inline">
              {% csrf_token %}
              <button type="submit" class="font-medium text-blue-600 hover:text-blue-500 focus:outline-none dark:text-blue-400">{% translate 'Log out' %}</button>
            </form>
          {% endblock %}
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</header>
{% endblock %}

{% block nav-breadcrumbs %}
  <nav class="mt-20 px-4 sm:ml-64 sm:px-8" aria-label="{% translate 'Breadcrumbs' %}">
    {% block breadcrumbs %}
      <ol class="flex flex-wrap items-center gap-2 text-sm text-gray-500 dark:text-gray-400">
        <li>
          <a class="inline-flex items-center gap-1 rounded-lg px-3 py-1 font-medium text-gray-600 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-white" href="{% url 'admin:index' %}">
            <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6" />
            </svg>
            {% translate 'Home' %}
          </a>
        </li>
        {% if title %}
        <li aria-hidden="true" class="text-gray-400">/</li>
        <li class="font-semibold text-gray-700 dark:text-gray-200">{{ title }}</li>
        {% endif %}
      </ol>
    {% endblock %}
  </nav>
{% endblock %}

{% block nav-sidebar %}
<aside id="logo-sidebar" class="fixed left-0 top-0 z-40 h-screen w-64 -translate-x-full border-r border-gray-200 bg-white pt-20 transition-transform dark:border-gray-700 dark:bg-gray-900 sm:translate-x-0" aria-label="{% translate 'Sidebar' %}">
  <div class="h-full overflow-y-auto px-4 pb-6">
    <div class="mb-6 hidden sm:block">
      <p class="text-xs font-semibold uppercase tracking-widest text-gray-400 dark:text-gray-500">{% translate 'Navigation' %}</p>
    </div>
    <ul class="space-y-1 text-sm font-medium">
      {% with apps=app_list|default:available_apps %}
        {% if apps %}
          {% for app in apps %}
            <li>
              <div class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400">{{ app.name }}</div>
              <ul class="mt-2 space-y-1">
                {% for model in app.models %}
                  <li>
                    {% if model.admin_url %}
                      <a href="{{ model.admin_url }}" class="flex items-center justify-between rounded-lg px-3 py-2 text-gray-600 transition hover:bg-blue-50 hover:text-blue-700 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-white">
                        <span>{{ model.name }}</span>
                        {% if model.add_url %}
                          <span class="text-xs font-semibold text-blue-600 dark:text-blue-400" title="{% translate 'Add' %}">+</span>
                        {% endif %}
                      </a>
                    {% else %}
                      <span class="flex items-center rounded-lg px-3 py-2 text-gray-400 dark:text-gray-500">{{ model.name }}</span>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            </li>
          {% endfor %}
        {% else %}
          <li class="rounded-lg bg-gray-50 px-3 py-4 text-sm text-gray-500 dark:bg-gray-800/50 dark:text-gray-400">{% translate 'You don\'t have permission to view or edit anything.' %}</li>
        {% endif %}
      {% endwith %}
    </ul>
  </div>
</aside>
{% endblock %}

{% block messages %}
  {% if messages %}
    <div class="mx-4 mt-24 space-y-4 sm:ml-64 sm:px-8">
      {% for message in messages %}
        {% with tags=message.tags|default:"" %}
          {% if 'error' in tags %}
            {% with 'red' as alert_color %}
              <div class="rounded-lg border border-{{ alert_color }}-200 bg-{{ alert_color }}-50 p-4 text-{{ alert_color }}-800 dark:border-{{ alert_color }}-900/50 dark:bg-{{ alert_color }}-900/30 dark:text-{{ alert_color }}-200">
                {{ message|capfirst }}
              </div>
            {% endwith %}
          {% elif 'success' in tags %}
            {% with 'green' as alert_color %}
              <div class="rounded-lg border border-{{ alert_color }}-200 bg-{{ alert_color }}-50 p-4 text-{{ alert_color }}-800 dark:border-{{ alert_color }}-900/50 dark:bg-{{ alert_color }}-900/30 dark:text-{{ alert_color }}-200">
                {{ message|capfirst }}
              </div>
            {% endwith %}
          {% elif 'warning' in tags %}
            {% with 'yellow' as alert_color %}
              <div class="rounded-lg border border-{{ alert_color }}-200 bg-{{ alert_color }}-50 p-4 text-{{ alert_color }}-800 dark:border-{{ alert_color }}-900/50 dark:bg-{{ alert_color }}-900/30 dark:text-{{ alert_color }}-200">
                {{ message|capfirst }}
              </div>
            {% endwith %}
          {% else %}
            {% with 'blue' as alert_color %}
              <div class="rounded-lg border border-{{ alert_color }}-200 bg-{{ alert_color }}-50 p-4 text-{{ alert_color }}-800 dark:border-{{ alert_color }}-900/50 dark:bg-{{ alert_color }}-900/30 dark:text-{{ alert_color }}-200">
                {{ message|capfirst }}
              </div>
            {% endwith %}
          {% endif %}
        {% endwith %}
      {% endfor %}
    </div>
  {% endif %}
{% endblock %}

{% block coltype %}colM mt-24 space-y-6 px-4 pb-12 sm:ml-64 sm:px-8{% endblock %}

{% block footer %}
  {{ block.super }}
  <script src="{% static 'flowbite_admin/js/flowbite.min.js' %}"></script>
  <script src="{% static 'flowbite_admin/js/flowbite-admin.js' %}"></script>
  <script>
    (function () {
      const themeToggleBtn = document.getElementById('theme-toggle');
      if (!themeToggleBtn) {
        return;
      }
      const darkIcon = document.getElementById('theme-toggle-dark-icon');
      const lightIcon = document.getElementById('theme-toggle-light-icon');
      function setIcons(isDark) {
        if (isDark) {
          darkIcon.classList.add('hidden');
          lightIcon.classList.remove('hidden');
        } else {
          lightIcon.classList.add('hidden');
          darkIcon.classList.remove('hidden');
        }
      }
      const storedTheme = localStorage.getItem('color-theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = storedTheme === 'dark' || (!storedTheme && prefersDark);
      setIcons(isDark);
      themeToggleBtn.addEventListener('click', function () {
        const isCurrentlyDark = document.documentElement.classList.contains('dark');
        if (isCurrentlyDark) {
          document.documentElement.classList.remove('dark');
          localStorage.setItem('color-theme', 'light');
          setIcons(false);
        } else {
          document.documentElement.classList.add('dark');
          localStorage.setItem('color-theme', 'dark');
          setIcons(true);
        }
      });
    })();
  </script>
{% endblock %}
